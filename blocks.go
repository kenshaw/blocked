package blocked

import (
	"fmt"
	"io"
	"math/bits"
	"strings"
)

// SolidsRunes returns the runes for single block resolution bitmaps.
func SolidsRunes() []rune {
	return []rune{
		' ', 'â–ˆ',
	}
}

// BinariesRunes returns the runes for single block resolution bitmaps using
// '0', '1'.
func BinariesRunes() []rune {
	return []rune{
		'0', '1',
	}
}

// XXsRunes returns the runes for single block resolution bitmaps using ' ',
// 'X'.
func XXsRunes() []rune {
	return []rune{
		' ', 'X',
	}
}

// HalvesRunes returns the runes for double block resolution bitmaps.
func HalvesRunes() []rune {
	return []rune{
		' ', 'â–€', 'â–„', 'â–ˆ',
	}
}

// ASCIIsRunes returns the runes for double block resolution bitmaps.
func ASCIIsRunes() []rune {
	return []rune{
		' ', '^', 'v', '%',
	}
}

// QuadsRunes returns the runes for quadruple block resolution bitmaps.
func QuadsRunes() []rune {
	return []rune{
		' ', 'â–˜', 'â–', 'â–€', 'â––', 'â–Œ', 'â–', 'â–›',
		'â–—', 'â–š', 'â–', 'â–œ', 'â–„', 'â–™', 'â–Ÿ', 'â–ˆ',
	}
}

// QuadsSeparatedRunes returns the runes for quadruple block resolution images
// using separated quads.
func QuadsSeparatedRunes() []rune {
	return []rune{
		'Â ', 'ğœ°¡', 'ğœ°¢', 'ğœ°£', 'ğœ°¤', 'ğœ°¥', 'ğœ°¦', 'ğœ°§',
		'ğœ°¨', 'ğœ°©', 'ğœ°ª', 'ğœ°«', 'ğœ°¬', 'ğœ°­', 'ğœ°®', 'ğœ°¯',
	}
}

// SextantsRunes returns the runes for sextuple block resolution images.
func SextantsRunes() []rune {
	return []rune{
		' ', 'ğŸ¬€', 'ğŸ¬', 'ğŸ¬‚', 'ğŸ¬ƒ', 'ğŸ¬„', 'ğŸ¬…', 'ğŸ¬†',
		'ğŸ¬‡', 'ğŸ¬ˆ', 'ğŸ¬‰', 'ğŸ¬Š', 'ğŸ¬‹', 'ğŸ¬Œ', 'ğŸ¬', 'ğŸ¬',
		'ğŸ¬', 'ğŸ¬', 'ğŸ¬‘', 'ğŸ¬’', 'ğŸ¬“', 'â–Œ', 'ğŸ¬”', 'ğŸ¬•',
		'ğŸ¬–', 'ğŸ¬—', 'ğŸ¬˜', 'ğŸ¬™', 'ğŸ¬š', 'ğŸ¬›', 'ğŸ¬œ', 'ğŸ¬',
		'ğŸ¬', 'ğŸ¬Ÿ', 'ğŸ¬ ', 'ğŸ¬¡', 'ğŸ¬¢', 'ğŸ¬£', 'ğŸ¬¤', 'ğŸ¬¥',
		'ğŸ¬¦', 'ğŸ¬§', 'â–', 'ğŸ¬¨', 'ğŸ¬©', 'ğŸ¬ª', 'ğŸ¬«', 'ğŸ¬¬',
		'ğŸ¬­', 'ğŸ¬®', 'ğŸ¬¯', 'ğŸ¬°', 'ğŸ¬±', 'ğŸ¬²', 'ğŸ¬³', 'ğŸ¬´',
		'ğŸ¬µ', 'ğŸ¬¶', 'ğŸ¬·', 'ğŸ¬¸', 'ğŸ¬¹', 'ğŸ¬º', 'ğŸ¬»', 'â–ˆ',
	}
}

// SextantsSeparatedRunes returns the runes for sextuple block resolution
// images using separated sextants.
func SextantsSeparatedRunes() []rune {
	return []rune{
		'Â ', 'ğœ¹‘', 'ğœ¹’', 'ğœ¹“', 'ğœ¹”', 'ğœ¹•', 'ğœ¹–', 'ğœ¹—',
		'ğœ¹˜', 'ğœ¹™', 'ğœ¹š', 'ğœ¹›', 'ğœ¹œ', 'ğœ¹', 'ğœ¹', 'ğœ¹Ÿ',
		'ğœ¹ ', 'ğœ¹¡', 'ğœ¹¢', 'ğœ¹£', 'ğœ¹¤', 'ğœ¹¥', 'ğœ¹¦', 'ğœ¹§',
		'ğœ¹¨', 'ğœ¹©', 'ğœ¹ª', 'ğœ¹«', 'ğœ¹¬', 'ğœ¹­', 'ğœ¹®', 'ğœ¹¯',
		'ğœ¹°', 'ğœ¹±', 'ğœ¹²', 'ğœ¹³', 'ğœ¹´', 'ğœ¹µ', 'ğœ¹¶', 'ğœ¹·',
		'ğœ¹¸', 'ğœ¹¹', 'ğœ¹º', 'ğœ¹»', 'ğœ¹¼', 'ğœ¹½', 'ğœ¹¾', 'ğœ¹¿',
		'ğœº€', 'ğœº', 'ğœº‚', 'ğœºƒ', 'ğœº„', 'ğœº…', 'ğœº†', 'ğœº‡',
		'ğœºˆ', 'ğœº‰', 'ğœºŠ', 'ğœº‹', 'ğœºŒ', 'ğœº', 'ğœº', 'ğœº',
	}
}

// OctantsRunes returns the runes for octuple block resolution images.
func OctantsRunes() []rune {
	return []rune{
		'Â ', 'ğœº¨', 'ğœº«', 'ğŸ®‚', 'ğœ´€', 'â–˜', 'ğœ´', 'ğœ´‚',
		'ğœ´ƒ', 'ğœ´„', 'â–', 'ğœ´…', 'ğœ´†', 'ğœ´‡', 'ğœ´ˆ', 'â–€',
		'ğœ´‰', 'ğœ´Š', 'ğœ´‹', 'ğœ´Œ', 'ğŸ¯¦', 'ğœ´', 'ğœ´', 'ğœ´',
		'ğœ´', 'ğœ´‘', 'ğœ´’', 'ğœ´“', 'ğœ´”', 'ğœ´•', 'ğœ´–', 'ğœ´—',
		'ğœ´˜', 'ğœ´™', 'ğœ´š', 'ğœ´›', 'ğœ´œ', 'ğœ´', 'ğœ´', 'ğœ´Ÿ',
		'ğŸ¯§', 'ğœ´ ', 'ğœ´¡', 'ğœ´¢', 'ğœ´£', 'ğœ´¤', 'ğœ´¥', 'ğœ´¦',
		'ğœ´§', 'ğœ´¨', 'ğœ´©', 'ğœ´ª', 'ğœ´«', 'ğœ´¬', 'ğœ´­', 'ğœ´®',
		'ğœ´¯', 'ğœ´°', 'ğœ´±', 'ğœ´²', 'ğœ´³', 'ğœ´´', 'ğœ´µ', 'ğŸ®…',
		'ğœº£', 'ğœ´¶', 'ğœ´·', 'ğœ´¸', 'ğœ´¹', 'ğœ´º', 'ğœ´»', 'ğœ´¼',
		'ğœ´½', 'ğœ´¾', 'ğœ´¿', 'ğœµ€', 'ğœµ', 'ğœµ‚', 'ğœµƒ', 'ğœµ„',
		'â––', 'ğœµ…', 'ğœµ†', 'ğœµ‡', 'ğœµˆ', 'â–Œ', 'ğœµ‰', 'ğœµŠ',
		'ğœµ‹', 'ğœµŒ', 'â–', 'ğœµ', 'ğœµ', 'ğœµ', 'ğœµ', 'â–›',
		'ğœµ‘', 'ğœµ’', 'ğœµ“', 'ğœµ”', 'ğœµ•', 'ğœµ–', 'ğœµ—', 'ğœµ˜',
		'ğœµ™', 'ğœµš', 'ğœµ›', 'ğœµœ', 'ğœµ', 'ğœµ', 'ğœµŸ', 'ğœµ ',
		'ğœµ¡', 'ğœµ¢', 'ğœµ£', 'ğœµ¤', 'ğœµ¥', 'ğœµ¦', 'ğœµ§', 'ğœµ¨',
		'ğœµ©', 'ğœµª', 'ğœµ«', 'ğœµ¬', 'ğœµ­', 'ğœµ®', 'ğœµ¯', 'ğœµ°',
		'ğœº ', 'ğœµ±', 'ğœµ²', 'ğœµ³', 'ğœµ´', 'ğœµµ', 'ğœµ¶', 'ğœµ·',
		'ğœµ¸', 'ğœµ¹', 'ğœµº', 'ğœµ»', 'ğœµ¼', 'ğœµ½', 'ğœµ¾', 'ğœµ¿',
		'ğœ¶€', 'ğœ¶', 'ğœ¶‚', 'ğœ¶ƒ', 'ğœ¶„', 'ğœ¶…', 'ğœ¶†', 'ğœ¶‡',
		'ğœ¶ˆ', 'ğœ¶‰', 'ğœ¶Š', 'ğœ¶‹', 'ğœ¶Œ', 'ğœ¶', 'ğœ¶', 'ğœ¶',
		'â–—', 'ğœ¶', 'ğœ¶‘', 'ğœ¶’', 'ğœ¶“', 'â–š', 'ğœ¶”', 'ğœ¶•',
		'ğœ¶–', 'ğœ¶—', 'â–', 'ğœ¶˜', 'ğœ¶™', 'ğœ¶š', 'ğœ¶›', 'â–œ',
		'ğœ¶œ', 'ğœ¶', 'ğœ¶', 'ğœ¶Ÿ', 'ğœ¶ ', 'ğœ¶¡', 'ğœ¶¢', 'ğœ¶£',
		'ğœ¶¤', 'ğœ¶¥', 'ğœ¶¦', 'ğœ¶§', 'ğœ¶¨', 'ğœ¶©', 'ğœ¶ª', 'ğœ¶«',
		'â–‚', 'ğœ¶¬', 'ğœ¶­', 'ğœ¶®', 'ğœ¶¯', 'ğœ¶°', 'ğœ¶±', 'ğœ¶²',
		'ğœ¶³', 'ğœ¶´', 'ğœ¶µ', 'ğœ¶¶', 'ğœ¶·', 'ğœ¶¸', 'ğœ¶¹', 'ğœ¶º',
		'ğœ¶»', 'ğœ¶¼', 'ğœ¶½', 'ğœ¶¾', 'ğœ¶¿', 'ğœ·€', 'ğœ·', 'ğœ·‚',
		'ğœ·ƒ', 'ğœ·„', 'ğœ·…', 'ğœ·†', 'ğœ·‡', 'ğœ·ˆ', 'ğœ·‰', 'ğœ·Š',
		'ğœ·‹', 'ğœ·Œ', 'ğœ·', 'ğœ·', 'ğœ·', 'ğœ·', 'ğœ·‘', 'ğœ·’',
		'ğœ·“', 'ğœ·”', 'ğœ·•', 'ğœ·–', 'ğœ·—', 'ğœ·˜', 'ğœ·™', 'ğœ·š',
		'â–„', 'ğœ·›', 'ğœ·œ', 'ğœ·', 'ğœ·', 'â–™', 'ğœ·Ÿ', 'ğœ· ',
		'ğœ·¡', 'ğœ·¢', 'â–Ÿ', 'ğœ·£', 'â–†', 'ğœ·¤', 'ğœ·¥', 'â–ˆ',
	}
}

// BrailleRunes returns the runes for octuple block resolution images using
// braille.
func BrailleRunes() []rune {
	return []rune{
		'â €', 'â ', 'â ˆ', 'â ‰', 'â ‚', 'â ƒ', 'â Š', 'â ‹',
		'â ', 'â ‘', 'â ˜', 'â ™', 'â ’', 'â “', 'â š', 'â ›',
		'â „', 'â …', 'â Œ', 'â ', 'â †', 'â ‡', 'â ', 'â ',
		'â ”', 'â •', 'â œ', 'â ', 'â –', 'â —', 'â ', 'â Ÿ',
		'â  ', 'â ¡', 'â ¨', 'â ©', 'â ¢', 'â £', 'â ª', 'â «',
		'â °', 'â ±', 'â ¸', 'â ¹', 'â ²', 'â ³', 'â º', 'â »',
		'â ¤', 'â ¥', 'â ¬', 'â ­', 'â ¦', 'â §', 'â ®', 'â ¯',
		'â ´', 'â µ', 'â ¼', 'â ½', 'â ¶', 'â ·', 'â ¾', 'â ¿',
		'â¡€', 'â¡', 'â¡ˆ', 'â¡‰', 'â¡‚', 'â¡ƒ', 'â¡Š', 'â¡‹',
		'â¡', 'â¡‘', 'â¡˜', 'â¡™', 'â¡’', 'â¡“', 'â¡š', 'â¡›',
		'â¡„', 'â¡…', 'â¡Œ', 'â¡', 'â¡†', 'â¡‡', 'â¡', 'â¡',
		'â¡”', 'â¡•', 'â¡œ', 'â¡', 'â¡–', 'â¡—', 'â¡', 'â¡Ÿ',
		'â¡ ', 'â¡¡', 'â¡¨', 'â¡©', 'â¡¢', 'â¡£', 'â¡ª', 'â¡«',
		'â¡°', 'â¡±', 'â¡¸', 'â¡¹', 'â¡²', 'â¡³', 'â¡º', 'â¡»',
		'â¡¤', 'â¡¥', 'â¡¬', 'â¡­', 'â¡¦', 'â¡§', 'â¡®', 'â¡¯',
		'â¡´', 'â¡µ', 'â¡¼', 'â¡½', 'â¡¶', 'â¡·', 'â¡¾', 'â¡¿',
		'â¢€', 'â¢', 'â¢ˆ', 'â¢‰', 'â¢‚', 'â¢ƒ', 'â¢Š', 'â¢‹',
		'â¢', 'â¢‘', 'â¢˜', 'â¢™', 'â¢’', 'â¢“', 'â¢š', 'â¢›',
		'â¢„', 'â¢…', 'â¢Œ', 'â¢', 'â¢†', 'â¢‡', 'â¢', 'â¢',
		'â¢”', 'â¢•', 'â¢œ', 'â¢', 'â¢–', 'â¢—', 'â¢', 'â¢Ÿ',
		'â¢ ', 'â¢¡', 'â¢¨', 'â¢©', 'â¢¢', 'â¢£', 'â¢ª', 'â¢«',
		'â¢°', 'â¢±', 'â¢¸', 'â¢¹', 'â¢²', 'â¢³', 'â¢º', 'â¢»',
		'â¢¤', 'â¢¥', 'â¢¬', 'â¢­', 'â¢¦', 'â¢§', 'â¢®', 'â¢¯',
		'â¢´', 'â¢µ', 'â¢¼', 'â¢½', 'â¢¶', 'â¢·', 'â¢¾', 'â¢¿',
		'â£€', 'â£', 'â£ˆ', 'â£‰', 'â£‚', 'â£ƒ', 'â£Š', 'â£‹',
		'â£', 'â£‘', 'â£˜', 'â£™', 'â£’', 'â£“', 'â£š', 'â£›',
		'â£„', 'â£…', 'â£Œ', 'â£', 'â£†', 'â£‡', 'â£', 'â£',
		'â£”', 'â£•', 'â£œ', 'â£', 'â£–', 'â£—', 'â£', 'â£Ÿ',
		'â£ ', 'â£¡', 'â£¨', 'â£©', 'â£¢', 'â££', 'â£ª', 'â£«',
		'â£°', 'â£±', 'â£¸', 'â£¹', 'â£²', 'â£³', 'â£º', 'â£»',
		'â£¤', 'â£¥', 'â£¬', 'â£­', 'â£¦', 'â£§', 'â£®', 'â£¯',
		'â£´', 'â£µ', 'â£¼', 'â£½', 'â£¶', 'â£·', 'â£¾', 'â£¿',
	}
}

// Dump dumps a ASCII drawing of the bitmask of the symobls to the writer.
//
// Used to verify the symbols for different [Type]'s.
func Dump(w io.Writer, syms map[uint8]rune) {
	n := len(syms)
	for i := range n {
		if i%8 == 0 {
			fmt.Fprintf(w, "%*s|", 3, "")
		}
		fmt.Fprintf(w, "%c", syms[uint8(i)])
		if i%8 == 7 || i == n-1 {
			fmt.Fprintln(w, "|")
		}
	}
	fmt.Fprintln(w)
	width := 8 - bits.LeadingZeros8(uint8(len(syms)-1))
	for i := range n {
		if i != 0 {
			fmt.Fprintln(w)
		}
		v := splitMask(uint8(i), width)
		fmt.Fprintf(w, "%3d: |%s| â”‚%câ”‚\n", i, v[0], syms[uint8(i)])
		for j := 1; j < len(v); j++ {
			fmt.Fprintf(w, "%3s  |%s|\n", "", v[j])
		}
	}
}

// splitMask splits a mask into n lines of m runes per line, where n is the `8 - width`
// signficant bits of i. If width is less than or equal to 2, each line will be
// 1 rune, otherwise each line will be 2 runes.
func splitMask(i uint8, width int) []string {
	s := maskRepl.Replace(fmt.Sprintf("%0*b", width, bits.Reverse8(uint8(i))>>(8-width)))
	var v []string
	n := 2
	if width <= 2 {
		n = 1
	}
	for i := 0; i < len(s); i += n {
		v = append(v, s[i:min(i+n, len(s))])
	}
	return v
}

// maskRepl replaces '0', '1' with ' ', 'X'.
var maskRepl = strings.NewReplacer(
	"0", " ",
	"1", "X",
)
